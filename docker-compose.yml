version: '2'
services:
  api:
    image: docker.montagu.dide.ic.ac.uk:5000/montagu-api:${MONTAGU_API_VERSION}
    ports:
      - "8080:8080"
    depends_on:
      - db
    volumes:
      - emails:/tmp/montagu_emails
  db:
    image: docker.montagu.dide.ic.ac.uk:5000/montagu-db:${MONTAGU_DB_VERSION}
    command: /etc/montagu/postgresql.test.conf
  db_annex:
    image: docker.montagu.dide.ic.ac.uk:5000/montagu-db:${MONTAGU_DB_VERSION}
    command: /etc/montagu/postgresql.test.conf
  orderly_web:
    image: vimc/orderly-web:master
    ports:
      - "8888:8888"
    volumes:
      - ${PWD}/src/demo:/orderly
      - ${PWD}/src/config/blackboxTests/orderlyweb:/etc/orderly/web
volumes:
  emails:
